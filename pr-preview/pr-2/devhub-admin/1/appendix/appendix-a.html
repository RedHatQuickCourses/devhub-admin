<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Integrating RHDH with an External PostgreSQL Database :: Red Hat Developer Hub Administration</title>
    <link rel="prev" href="../chapter2/rbac.html">
    <meta name="generator" content="Antora 3.1.3">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <script>var uiRootPath = '../../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://www.redhat.com" target="_blank"><img src="../../../_/img/redhat-logo.png" height="40px" alt="Red Hat"></a>
      <a class="navbar-item" style="font-size: 24px; color: white" href="../../..">Red Hat Developer Hub Administration</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="https://github.com/RedHatQuickCourses/devhub-admin/issues" target="_blank">Report Issues</a>
      </div>
    </div>
  </nav>
</header><div class="body">
<div class="nav-container" data-component="devhub-admin" data-version="1">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">Red Hat Developer Hub Administration</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../index.html">Home</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../chapter1/index.html">Installation</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter1/install.html">Installing RHDH</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter1/upgrade.html">Upgrading RHDH</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter1/uninstall.html">Uninstalling RHDH</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../chapter2/index.html">Basic Configuration</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter2/basic-config.html">Basic Configuration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter2/git-auth.html">GitHub Authentication</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter2/rbac.html">Role Based Access Control</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item is-current-page" data-depth="1">
    <a class="nav-link" href="appendix-a.html">Appendix A: External PostgreSQL DB</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Red Hat Developer Hub Administration</span>
    <span class="version">1</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../index.html">Red Hat Developer Hub Administration</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">1</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">Red Hat Developer Hub Administration</a></li>
    <li><a href="appendix-a.html">Appendix A: External PostgreSQL DB</a></li>
  </ul>
</nav>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Integrating RHDH with an External PostgreSQL Database</h1>
<div id="preamble">
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This section is for informational purposes only. Do not make these changes in your classroom environment because you do not have access to an external PostgreSQL database instance. You will continue to work with the default PostgreSQL database that was installed during RHDH installation for the rest of the course.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For large scale production rollouts, it is recommended to use an external PostgreSQL database instead of the default database provisioned by the RHDH installation process.</p>
</div>
<div class="paragraph">
<p>To integrate your RHDH instance with an external PostgreSQL database instance, do the following:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Edit or create the <strong>app-config-rhdh</strong> ConfigMap if it does not exist, and add the configuration for accessing the external PostgreSQL database. Ensure that the <code>backend</code> attribute is added at the same level as <code>app</code> (that is, below the <code>app-config-rhdh.yaml</code> data element):</p>
<div class="listingblock">
<div class="content">
<pre>app-config-rhdh.yaml: |
    app:
      title: Red Hat Developer Hub
<strong>backend:
  database:
    client: pg
    connection:
      host: mydbhost.example.com
      port: 5432
      user: ${POSTGRES_USER}
      password: ${POSTGRES_PASSWORD}</strong></pre>
</div>
</div>
</li>
<li>
<p>Click <code>Save</code> to save the configuration changes.</p>
</li>
<li>
<p>If you have RHDH already installed, skip this step and jump to the next step. Otherwise, follow the instructions in the <a href="../chapter1/install.html#_install_the_rhdh_helm_chart" class="xref page">Red Hat Developer Hub Installation</a> section to install RHDH using helm charts. In the <code>Create Helm Release</code> page, select <code>YAML View</code> to edit the helm chart values outlined in the next steps.</p>
</li>
<li>
<p>If you have RHDH already installed, in the <code>Helm Releases</code> page, select the <code>Upgrade</code> option for the <strong>rhdh</strong> helm chart.</p>
</li>
<li>
<p>Select <code>YAML View</code> in the <code>Configure via</code> field to view the helm chart values as YAML</p>
</li>
<li>
<p>Search the <code>postgresql.enabled</code> field and set it to <strong>false</strong> to prevent the helm chart from deploying a database.</p>
<div class="listingblock">
<div class="content">
<pre>postgresql:
    auth:
      secretKeys:
        adminPasswordKey: postgres-password
        userPasswordKey: password
    enabled: <strong>false</strong></pre>
</div>
</div>
</li>
<li>
<p>Click <code>Upgrade</code> to redeploy the RHDH instance. It may take some time for the RHDH pods to be redeployed.
Verify that the integration was successful by navigating to the RHDH home page.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_references"><a class="anchor" href="#_references"></a>References</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="https://backstage.io/docs/getting-started/configuration#install-and-configure-postgresql" target="_blank" rel="noopener">Configure PostgreSQL database in Backstage</a></p>
</li>
</ul>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="../chapter2/rbac.html">Role Based Access Control</a></span>
</nav>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <img src="../../../_/img/rhl-logo-red.png" height="40px" alt="Red Hat"  href="https://redhat.com" >
</footer><script id="site-script" src="../../../_/js/site.js" data-ui-root-path="../../../_"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
